! Title: Microsoft 365 Filters (uBlock Origin)
! Description: Microsoft 365 web app cleanup — ads, Copilot, upsells, telemetry, annoyances
! Last modified:
!
! Covers: Teams, Outlook Web, SharePoint Online, OneDrive Web, Office portal,
!         Office Web Apps (Word/Excel/PowerPoint/OneNote Online), Power Platform
! Browser: Firefox recommended (full uBO MV2 support); Brave also works.
!          Chrome/Edge users need uBlock Origin Lite (limited procedural filter support).
!
! Note: Microsoft frequently changes class names and DOM structure.
!       Procedural filters (:has-text, :has, :upward) are more resilient
!       than class-based selectors. If a rule stops working, use the Element
!       Picker (right-click > Block element) to regenerate it.
!
! Sources & references:
!   https://github.com/uBlockOrigin/uAssets/issues/26115 (Outlook.live.com ad filters)
!   https://github.com/uBlockOrigin/uAssets/issues/17041 (Office telemetry)
!   https://github.com/Stevoisiak/Stevos-GenAI-Blocklist (Copilot/GenAI filters)
!   https://gist.github.com/arcv/51e0e4ed0ff94b906b83939304b0acc7 (Outlook upgrade nag)
!   https://github.com/Pyenb/Outlook-desktop-ad-blocker (Outlook ad domains)
!   https://github.com/uBlockOrigin/uAssets/blob/master/filters/privacy.txt (MS telemetry)
!   https://github.com/pschneider1968/pihole-bl-msft-telemetry-bsi (BSI telemetry list)

! =====================================================================
! SECTION 1: MICROSOFT 365 PORTAL (office.com, microsoft365.com, m365)
! =====================================================================

! --- Copilot UI removal on M365 cloud portal ---

! Copilot chat input wrapper in the M365 portal
m365.cloud.microsoft###chat-input-wrapper

! Copilot companion pane adjacent to main content
m365.cloud.microsoft##.___g910dn0 > .___xtcqig0

! Copilot sidebar nav button and related entries
m365.cloud.microsoft##.fui-NavDrawerBody > [data-testid="core-modules-section"] > button
m365.cloud.microsoft##.fui-NavDrawerBody > .___wvxaoh0.f22iagw.f1vx9l62.fnknrz3.f5yzyt

! Copilot prompts in Edgeworth item cards (app launcher)
m365.cloud.microsoft##.EdgeworthItemControl-module__copilot-prompts__BhZZG
m365.cloud.microsoft##.EdgeworthItemControl-module__title-icon-button__UewmV

! Copilot chat entry in sidebar navigation
m365.cloud.microsoft##div.fui-NavDrawerBody > div.___12uu7fi.f22iagw.f1vx9l62.f7e3wsx > #chat
m365.cloud.microsoft##div.fui-NavDrawerBody > div.___12uu7fi.f22iagw.f1vx9l62.f7e3wsx > .___1vgvawp

! --- Promotional banners on microsoft.com / cloud.microsoft ---

! Copilot app tile in the M365 app launcher
cloud.microsoft,microsoft.com###O365_AppTile_Microsoft365Tile:upward(1)

! Copilot links in the top navigation/header menu
www.microsoft.com,cloud.microsoft##:is(#shellmenu_2, #shellmenu_2-mo)[href="https://copilot.microsoft.com/"]
www.microsoft.com,cloud.microsoft##.c-uhff-nav-group > .c-list > li:has(> a:is([aria-label*="Copilot"]))

! Promotional banner in the universal header (e.g., "Try Copilot" hero banner)
www.microsoft.com,cloud.microsoft###headerUniversalHeader > #epb:has(> div[aria-label="Promotional Banner"])

! Chat-on-page Copilot widget (floating chat bubble)
www.microsoft.com##div.chatonpage

! --- Upgrade / upsell banners on office.com ---

! "Upgrade to Microsoft 365" banners (text-based matching for resilience)
office.com,microsoft365.com##div:has(> :has-text(/Upgrade to Microsoft 365/i)):not(head):not(script)
office.com,microsoft365.com##div:has(> :has-text(/Try Microsoft 365/i)):not(head):not(script)

! Upsell banners (class-based, less stable)
office.com,microsoft365.com##div[class*="UpsellBanner"]
office.com,microsoft365.com##div[class*="upsell"]
office.com,microsoft365.com##div[class*="upgrade"]
office.com,microsoft365.com##div[class*="premium-banner"]

! App install prompts (fixed-position banners saying "Get the app")
office.com,microsoft365.com##div:has(> :has-text(/Get the app/i)):matches-css(position: fixed)
office.com,microsoft365.com##div:has(> :has-text(/Install the app/i)):matches-css(position: fixed)

! "What's new" / feature promo banners
office.com,microsoft365.com##div[class*="whats-new"]
office.com,microsoft365.com##div[class*="feature-tour"]

! Feedback prompts
office.com,microsoft365.com##div[class*="feedback"]
office.com,microsoft365.com##div[role="dialog"]:has-text(/feedback|survey|rate/i)

! =====================================================================
! SECTION 2: MICROSOFT TEAMS (teams.microsoft.com)
! =====================================================================

! --- Copilot removal in Teams ---

! Copilot app entry in the Teams sidebar/app rail
teams.microsoft.com###b5abf2ae-c16b-4310-8f8a-d3bcdb52f162
teams.microsoft.com##[data-testid="list-item-metaos-copilot"]

! Copilot plugins and featured AI apps in the Teams app store
teams.microsoft.com##[data-tid="store-provider-app:co:copilotplugins"]
teams.microsoft.com##[data-tid="store-provider-app:co:abc1"]
teams.microsoft.com##[data-tid="store-collection-app:co:featuredapps"]
teams.microsoft.com##[data-tid="store-collection-app:co:abc1"]

! "Includes an agent and uses AI" badge on app listings
teams.microsoft.com##svg[aria-label="Includes an agent and uses AI"]

! Copilot promo text-based matching
teams.microsoft.com##div[class*="copilot"]:has-text(/Try Copilot|Get Copilot/i)
teams.microsoft.com##div[class*="teaching-bubble"]:has-text(/Copilot/i)

! --- Feature announcement popups ---

! "What's new" and feature discovery dialogs (text-based for resilience)
teams.microsoft.com##div[role="dialog"]:has(> :has-text(/What's new/i))
teams.microsoft.com##div[role="dialog"]:has(> :has-text(/Discover the new/i))
teams.microsoft.com##div[role="dialog"]:has(> :has-text(/Try the new/i))

! Teaching callout bubbles and coachmarks
teams.microsoft.com##div[class*="teachingCallout"]
teams.microsoft.com##div[class*="coachmark"]
teams.microsoft.com##div[class*="Coachmark"]
teams.microsoft.com##div[class*="whats-new"]
teams.microsoft.com##div[class*="feature-tour"]
teams.microsoft.com##div[class*="teaching-bubble"]

! --- Upgrade and premium upsell prompts ---

teams.microsoft.com##div:has(> :has-text(/Upgrade your plan/i)):not(head)
teams.microsoft.com##div:has(> :has-text(/Get Microsoft Teams Premium/i)):not(head)
teams.microsoft.com##div:has(> :has-text(/Try Premium/i)):not(head)
teams.microsoft.com##div[class*="upgrade-banner"]
teams.microsoft.com##div[class*="premium-banner"]
teams.microsoft.com##div[data-tid*="upgrade"]
teams.microsoft.com##div[data-tid*="premium"]
teams.microsoft.com##div[class*="upsell"]

! --- Feedback and survey prompts ---

teams.microsoft.com##div[role="dialog"]:has(> :has-text(/How was your experience/i))
teams.microsoft.com##div[role="dialog"]:has(> :has-text(/Rate your experience/i))
teams.microsoft.com##div[role="dialog"]:has(> :has-text(/Give us feedback/i))
teams.microsoft.com##div[role="dialog"]:has(> :has-text(/Send feedback/i))
teams.microsoft.com##div[role="dialog"]:has-text(/feedback|rate your experience|survey/i)
teams.microsoft.com##div[class*="surveyContainer"]
teams.microsoft.com##div[class*="nps-survey"]

! --- Informational bars and banners ---

! Banner bars (e.g., "Try the new Teams", "Switch to new Teams")
teams.microsoft.com##div[class*="InfoBar"]:has-text(/new Teams/i)
teams.microsoft.com##div[class*="MessageBar"]:has-text(/new Teams/i)
teams.microsoft.com##div[class*="InfoBar"]:has-text(/Switch to/i)

! teams.live.com variants (consumer Teams)
teams.live.com##div[class*="upgrade-banner"]
teams.live.com##div[class*="upsell"]
teams.live.com##div[class*="whats-new"]
teams.live.com##div[class*="teaching-bubble"]
teams.live.com##div[role="dialog"]:has-text(/feedback|rate your experience|survey/i)

! =====================================================================
! SECTION 3: OUTLOOK WEB (outlook.live.com, outlook.office.com)
! =====================================================================

! --- Display ads on free Outlook (outlook.live.com) ---
! Source: https://github.com/uBlockOrigin/uAssets/issues/26115

! Right-side banner ads (identified by "Ad Choices" text)
outlook.live.com##div[id="MainModule"] > div > div > div:has( > div > div > span:has-text(Ad Choices))

! Bottom-side banner ads (visible on narrower viewports)
outlook.live.com##div[id="mainApp"] > div > div > div:has( > div > div > span:has-text(Ad Choices))

! Top-side banner ads above the mail list
outlook.live.com##div[id="Skip to message list-region"] > div[id]:not([id="MailList"])

! In-mailbox ad entries (fake "emails" that are ads — no data-convid attribute)
outlook.live.com##div[id="MailList"] > div > div > div > div > div > div > div > div:has( > div > div:not([data-convid]))

! Generic ad panel selectors (class-based, less stable)
outlook.live.com##div[class*="GssVb"]
outlook.live.com##div[class*="_3LrWF"]
outlook.live.com##div[role="complementary"]:has(iframe)
outlook.live.com###RightRailContainer iframe
outlook.live.com##div[data-app-section="RightRail"]:has(iframe[src*="ads"])

! --- Promotional content in reading pane ---

! Hide non-email content in reading pane (e.g., mobile app QR code promo)
outlook.live.com##div[id="ReadingPaneContainerId"] > div > div > div > div:not([id="ItemReadingPaneContainer"])

! Message bar prompts (unsubscribe suggestions, info bars)
outlook.live.com##div[class^="fui-MessageBarGroup"]

! --- "Upgrade Your Account" row ---
! Source: https://gist.github.com/arcv/51e0e4ed0ff94b906b83939304b0acc7
outlook.live.com##span:has-text(Microsoft Outlook):upward(8)

! --- Premium / upgrade upsells (text-based) ---

outlook.live.com##div:has(> :has-text(/Upgrade to Premium/i)):not(head)
outlook.live.com##div:has(> :has-text(/Try Premium/i)):not(head)
outlook.live.com##div:has(> :has-text(/Go Premium/i)):not(head)
outlook.live.com##div:has(> :has-text(/Go ad-free/i)):not(head)
outlook.live.com##div:has-text(/Get Microsoft 365/i):matches-attr(class="/upsell|premium|upgrade/i")

! "Upgrade to Premium" button (legacy selector)
outlook.live.com##._n_15

! Upsell class-based selectors
outlook.live.com##div[class*="upsell"]
outlook.live.com##div[class*="premium-banner"]
outlook.live.com##a[href*="premium"][class*="upsell"]

! outlook.office.com (work/school accounts) upsells
outlook.office.com##div:has(> :has-text(/Upgrade/i)):matches-css(position: fixed)
outlook.office.com##div:has(> :has-text(/Try Copilot/i)):not(head)
outlook.office.com##div[class*="upsell"]
outlook.office.com##div[class*="premium-banner"]
outlook.office365.com##div:has(> :has-text(/Upgrade/i)):matches-css(position: fixed)
outlook.office365.com##div:has(> :has-text(/Try Copilot/i)):not(head)

! Focused inbox promo banner
outlook.live.com##div[class*="FocusedInboxBanner"]
outlook.office.com##div[class*="FocusedInboxBanner"]

! "Discover" / "Suggested" panel items
outlook.live.com##div[aria-label*="Suggestions"]
outlook.live.com##div[aria-label*="Discover"]

! --- Copilot in Outlook Web ---

! Copilot button in toolbar
outlook.live.com##button[aria-label*="Copilot"]
outlook.office.com##button[aria-label*="Copilot"]
outlook.office365.com##button[aria-label*="Copilot"]

! Copilot summary bar on email reading pane
outlook.live.com##div:has(> :has-text(/Summarize with Copilot/i)):not(head)
outlook.office.com##div:has(> :has-text(/Summarize with Copilot/i)):not(head)
outlook.office365.com##div:has(> :has-text(/Summarize with Copilot/i)):not(head)

! Copilot pane / panel (class-based)
outlook.live.com##div[class*="CopilotPanel"]
outlook.office.com##div[class*="CopilotPanel"]

! Copilot promo text matches
outlook.live.com##div[class*="copilot"]:has-text(/Try Copilot|Get Copilot/i)
outlook.office.com##div[class*="copilot"]:has-text(/Try Copilot|Get Copilot/i)
outlook.live.com##div[class*="teaching-bubble"]:has-text(/Copilot/i)
outlook.office.com##div[class*="teaching-bubble"]:has-text(/Copilot/i)

! Copilot upsell buttons
outlook.live.com##button:has-text(/Copilot/i):has([class*="upsell"])
outlook.office.com##button:has-text(/Copilot/i):has([class*="upsell"])

! --- "Get the Outlook app" / mobile app promos ---

outlook.live.com##div:has(> :has-text(/Get the Outlook app/i)):not(head)
outlook.live.com##div:has(> :has-text(/Scan this QR code/i)):not(head)
outlook.office.com##div:has(> :has-text(/Get the Outlook app/i)):not(head)

! --- Feedback / survey prompts ---

outlook.live.com##div[class*="feedback"]
outlook.live.com##div[class*="survey"]
outlook.live.com##div[role="dialog"]:has-text(/feedback|survey|rate/i)
outlook.live.com##div[role="dialog"]:has(> :has-text(/How was your experience/i))
outlook.live.com##div[role="dialog"]:has(> :has-text(/Rate your experience/i))
outlook.live.com##div[role="dialog"]:has(> :has-text(/Give feedback/i))
outlook.office.com##div[class*="feedback"]
outlook.office.com##div[class*="survey"]
outlook.office.com##div[role="dialog"]:has-text(/feedback|survey|rate/i)
outlook.office.com##div[role="dialog"]:has(> :has-text(/How was your experience/i))
outlook.office.com##div[role="dialog"]:has(> :has-text(/Rate your experience/i))
outlook.office.com##div[role="dialog"]:has(> :has-text(/Give feedback/i))

! =====================================================================
! SECTION 4: SHAREPOINT ONLINE (*.sharepoint.com)
! =====================================================================

! --- Copilot / AI in SharePoint ---

! "Design Ideas" Copilot button on SharePoint pages
! Source: https://github.com/Stevoisiak/Stevos-GenAI-Blocklist
sharepoint.com##[data-automation-id="designIdeas"]:upward(1)

! --- Promotional banners ---

sharepoint.com##div:has(> :has-text(/Try the new/i)):matches-css(position: fixed)
sharepoint.com##div:has(> :has-text(/Upgrade your plan/i)):not(head)
sharepoint.com##div[class*="PromotionalBanner"]
sharepoint.com##div[class*="promotionalBanner"]
sharepoint.com##div[class*="app-banner"]
sharepoint.com##div[class*="upsell"]

! --- Feedback and survey prompts ---

sharepoint.com##div[role="dialog"]:has(> :has-text(/Give us feedback/i))
sharepoint.com##div[role="dialog"]:has(> :has-text(/How was your experience/i))
sharepoint.com##div[role="dialog"]:has(> :has-text(/Rate your experience/i))
sharepoint.com##div[role="dialog"]:has(> :has-text(/Help us improve/i))
sharepoint.com##div[role="dialog"]:has-text(/feedback|survey|rate/i)
sharepoint.com##div[class*="FeedbackDialog"]
sharepoint.com##div[class*="surveyContainer"]
sharepoint.com##div[id*="feedback-dialog"]
sharepoint.com##div[class*="feedback"]
sharepoint.com##div[class*="survey"]

! --- "What's new" / feature discovery ---

sharepoint.com##div[role="dialog"]:has(> :has-text(/What's new/i))
sharepoint.com##div[class*="teachingCallout"]
sharepoint.com##div[class*="Coachmark"]
sharepoint.com##div[class*="whats-new"]
sharepoint.com##div[class*="teaching-bubble"]
sharepoint.com##div[class*="coachmark"]

! =====================================================================
! SECTION 5: ONEDRIVE WEB (onedrive.live.com)
! =====================================================================

! --- Storage upgrade upsell prompts (text-based) ---

onedrive.live.com##div:has(> :has-text(/Get more storage/i)):not(head)
onedrive.live.com##div:has(> :has-text(/Storage is almost full/i)):not(head)
onedrive.live.com##div:has(> :has-text(/Upgrade your storage/i)):not(head)
onedrive.live.com##div:has(> :has-text(/You're running out of space/i)):not(head)
onedrive.live.com##div:has(> :has-text(/Upgrade to Microsoft 365/i)):not(head)
onedrive.live.com##div:has(> :has-text(/Try Premium/i)):not(head)
onedrive.live.com##div:has(> :has-text(/Go Premium/i)):not(head)

! Storage/upsell class-based selectors
onedrive.live.com##div[class*="UpsellBanner"]
onedrive.live.com##div[class*="upsell"]
onedrive.live.com##div[class*="upgrade"]
onedrive.live.com##div[class*="storage-warning"]
onedrive.live.com##div[class*="StorageUpsell"]
onedrive.live.com##a[href*="upgradestorage"]
onedrive.live.com##div[role="dialog"]:has-text(/upgrade your storage|get more storage/i)

! --- Ads and promotional content ---

onedrive.live.com##div:has(> span:has-text(Ad Choices))

! --- Feedback prompts ---

onedrive.live.com##div[class*="feedback"]
onedrive.live.com##div[role="dialog"]:has-text(/feedback|survey|rate/i)
onedrive.live.com##div[role="dialog"]:has(> :has-text(/Give feedback/i))
onedrive.live.com##div[role="dialog"]:has(> :has-text(/How was your experience/i))
onedrive.live.com##div[role="dialog"]:has(> :has-text(/Rate your experience/i))

! =====================================================================
! SECTION 6: OFFICE WEB APPS (Word, Excel, PowerPoint, OneNote Online)
! =====================================================================

! --- Copilot ribbon buttons in Office Web Apps ---
! Source: https://github.com/Stevoisiak/Stevos-GenAI-Blocklist

! Word Online — Copilot Chat ribbon group
usc-word-edit.officeapps.live.com###CopilotChat-group:upward(2)

! OneNote Online — Copilot Chat ribbon group
usc-onenote.officeapps.live.com###CopilotChat-group:upward(2)

! Excel Online — Copilot ribbon group
usc-excel.officeapps.live.com###Copilot-group:upward(2)

! PowerPoint Online — Copilot (ChatPPT) ribbon group
usc-powerpoint.officeapps.live.com###ChatPPT-group:upward(2)

! =====================================================================
! SECTION 7: MICROSOFT LEARN (learn.microsoft.com)
! =====================================================================

! AI assistant entry point on Learn homepage
learn.microsoft.com##[data-assistant-on-homepage="enabled"]

! "Ask Learn" AI assistant button
learn.microsoft.com##[data-bi-name="ask-learn-assistant-entry"]

! AI-generated summary sections
learn.microsoft.com##[data-id="ai-summary"]

! =====================================================================
! SECTION 8: MICROSOFT POWER PLATFORM
! =====================================================================

! Power Automate — Copilot banner and AI hub
make.powerautomate.com##[data-automation-id="copilotBanner"]:upward(2)
make.powerautomate.com##[data-test-id="aiHub"], [data-test-id="aiPrompts"]
make.powerautomate.com##.wrapper-178[href="https://copilotstudio.microsoft.com"]

! Power Platform admin center — Copilot overview link
admin.powerplatform.microsoft.com##button[value="/copilot/overview"]

! =====================================================================
! SECTION 9: NETWORK FILTERS — TELEMETRY & TRACKING
! =====================================================================

! --- Microsoft Aria telemetry system ---
! Used across all M365 web apps for diagnostic/behavioral data collection.
! Source: https://github.com/uBlockOrigin/uAssets/issues/17041
!
! WARNING: Blocking browser.pipe.aria.microsoft.com entirely may break
! Teams login (it enters an infinite loop). The rules below use $xhr to
! target only XHR/fetch telemetry requests, not page navigation.

! Office Apps telemetry wildcard (Word, Excel, PPT, OneNote web)
-telemetry.officeapps.live.com$ping,xhr

! Power Automate internal telemetry
||flow.microsoft.com/providers/Internal.Telemetry

! Browser events telemetry on apps.microsoft.com
||browser.events.data.microsoft.com^$domain=apps.microsoft.com

! General M365 telemetry endpoints
||browser.pipe.aria.microsoft.com^$xhr
||mobile.pipe.aria.microsoft.com^$xhr
||self.events.data.microsoft.com^$xhr
||functional.events.data.microsoft.com^$xhr
||telemetry.microsoft.com^$xhr

! Office web app telemetry beacons
||office.live.com/start/Telemetry$xhr
||c.microsoft.com/ms.js$script
||c.bing.com/c.gif$image
||c1.microsoft.com/c.gif$image

! --- Microsoft telemetry cookies ---
! Source: uBlockOrigin/uAssets privacy.txt
bing.com,microsoft.com,msn.com,web.skype.com##+js(cookie-remover, MicrosoftApplicationsTelemetryDeviceId, when, scroll keydown)
web.skype.com##+js(cookie-remover, MicrosoftApplicationsTelemetryFirstLaunchTime)
microsoft.com##+js(trusted-set-cookie, MicrosoftApplicationsTelemetryDeviceId, , 0)

! --- Ad-serving domains used by Outlook web (outlook.live.com) ---
||outlookads.live.com^
||m.adnxs.com^$domain=outlook.live.com
||acdn.adnxs.com^$domain=outlook.live.com
||api.taboola.com^$domain=outlook.live.com
||3lift.com^$domain=outlook.live.com
||ads.msn.com^$domain=outlook.live.com|office.com
||adsyndication.msn.com^$domain=outlook.live.com|office.com

! Additional MSN/Bing ad network domains
||ads.msn.com^$third-party
||adsyndication.msn.com^$third-party
||flexrev.msn.com^$third-party
||rad.msn.com^$third-party
||mads.msn.com^$third-party

! Microsoft advertising platforms
||ads.microsoft.com^$third-party
||adnxs.com^$third-party
||bat.bing.com^$third-party

! --- Microsoft feedback/NPS survey endpoints ---
||hubblecontent.osi.office.net^$xhr
||oteljs.azurefd.net^$script
||outlookmobile.live.com/api/v2/feedback$xhr
||aka.ms/feedback$xhr

! --- Tracking parameter removal on Microsoft domains ---
||office.com^$removeparam=ocid
||microsoft.com^$removeparam=ocid
||microsoft.com^$removeparam=msockid
||microsoft365.com^$removeparam=ocid
||live.com^$removeparam=ocid

! --- Optional: Aggressive telemetry domain blocking ---
! Uncomment below ONLY if you accept the risk of potential breakage.
! Blocking browser.pipe.aria.microsoft.com may break Teams login.
! Blocking nexus/nexusrules may affect Office Online functionality.
!
! ||browser.pipe.aria.microsoft.com^$domain=~teams.microsoft.com
! ||nexus.officeapps.live.com^
! ||nexusrules.officeapps.live.com^
! ||client-office365-tas.msedge.net^
! ||config.edge.skype.com^
! ||officeclient.microsoft.com^

! =====================================================================
! SECTION 10: CROSS-SITE MICROSOFT ANNOYANCES
! =====================================================================

! --- Generic feedback / NPS survey dialogs across all M365 domains ---
microsoft.com,office.com,microsoft365.com,sharepoint.com,onedrive.live.com,outlook.live.com,outlook.office.com,teams.microsoft.com##div[id*="nps-survey"]
microsoft.com,office.com,microsoft365.com,sharepoint.com,onedrive.live.com,outlook.live.com,outlook.office.com,teams.microsoft.com##div[class*="nps-survey"]
microsoft.com,office.com,microsoft365.com,sharepoint.com,onedrive.live.com,outlook.live.com,outlook.office.com,teams.microsoft.com##div[class*="SurveyDialog"]

! --- Cookie consent / privacy banners ---
microsoft.com,office.com,microsoft365.com##div[id="uhf-cookie-banner"]
microsoft.com,office.com,microsoft365.com##div[id*="consent-banner"]
microsoft.com,office.com,microsoft365.com##div[class*="cookie-banner"]
microsoft.com,office.com,microsoft365.com##div[class*="CookieBanner"]

! --- Microsoft Rewards / Bing promotion banners ---
office.com,microsoft365.com##div:has(> :has-text(/Microsoft Rewards/i)):not(head)
office.com,microsoft365.com##div:has(> :has-text(/Earn points/i)):not(head)

! --- "Download Edge" / "Switch to Edge" prompts ---
office.com,microsoft365.com,outlook.live.com##div:has(> :has-text(/Try Microsoft Edge/i)):not(head)
office.com,microsoft365.com,outlook.live.com##div:has(> :has-text(/Download Microsoft Edge/i)):not(head)
office.com,microsoft365.com,outlook.live.com##div:has(> :has-text(/Switch to Edge/i)):not(head)

! --- Copilot promo teaching callouts (cross-app) ---
office.com,microsoft365.com##div[class*="copilot"]:has-text(/Try Copilot|Get Copilot/i)
office.com,microsoft365.com##div[class*="teaching-bubble"]:has-text(/Copilot/i)
teams.microsoft.com##button:has-text(/Copilot/i):has([class*="upsell"])
